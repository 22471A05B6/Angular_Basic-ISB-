<div class="booking-container">
  <h2>Book Your Trip</h2>

  <form #bookingForm="ngForm" (ngSubmit)="submitForm(bookingForm)">

    <!-- NAME -->
    <input type="text"
           name="name"
           [(ngModel)]="booking.name"
           #name="ngModel"
           required
           minlength="3"
           placeholder="Full Name">

    <div class="error" *ngIf="name.invalid && name.touched">
      <div *ngIf="name.errors?.['required']">
        Name is required.
      </div>
      <div *ngIf="name.errors?.['minlength']">
        Minimum 3 characters required.
      </div>
    </div>


    <!-- EMAIL -->
    <input type="email"
           name="email"
           [(ngModel)]="booking.email"
           #email="ngModel"
           required
           email
           placeholder="Email">

    <div class="error" *ngIf="email.invalid && email.touched">
      <div *ngIf="email.errors?.['required']">
        Email is required.
      </div>
      <div *ngIf="email.errors?.['email']">
        Enter a valid email address.
      </div>
    </div>


    <!-- PHONE -->
    <input type="tel"
           name="phone"
           [(ngModel)]="booking.phone"
           #phone="ngModel"
           required
           pattern="^[0-9]{10}$"
           placeholder="Phone Number (10 digits)">

    <div class="error" *ngIf="phone.invalid && phone.touched">
      <div *ngIf="phone.errors?.['required']">
        Phone number is required.
      </div>
      <div *ngIf="phone.errors?.['pattern']">
        Phone number must be exactly 10 digits.
      </div>
    </div>


    <!-- DESTINATION -->
    <select name="destination"
            [(ngModel)]="booking.destination"
            #destination="ngModel"
            required
            (change)="updatePrice()">

      <option value="">Select Destination</option>
      <option *ngFor="let dest of destinations"
              [value]="dest.name">
        {{ dest.name }}
      </option>
    </select>

    <div class="error" *ngIf="destination.invalid && destination.touched">
      Destination selection is required.
    </div>


    <!-- PRICE -->
    <div *ngIf="selectedPrice > 0" class="highlighted-price">
      Price per Person: ₹{{ selectedPrice }}
    </div>


    <!-- DATE -->
    <input type="date"
           name="date"
           [(ngModel)]="booking.date"
           #date="ngModel"
           [min]="minDate"
           required>

    <div class="error" *ngIf="date.invalid && date.touched">
      Travel date is required.
    </div>


    <!-- PERSONS -->
    <input type="number"
           name="persons"
           [(ngModel)]="booking.persons"
           #persons="ngModel"
           min="1"
           required
           (input)="calculateTotal()"
           placeholder="Number of Persons">

    <div class="error" *ngIf="persons.invalid && persons.touched">
      <div *ngIf="persons.errors?.['required']">
        Number of persons is required.
      </div>
      <div *ngIf="persons.errors?.['min']">
        Minimum 1 person required.
      </div>
    </div>


    <!-- TOTAL -->
    <div *ngIf="totalAmount > 0" class="total-box">
      Total Amount: ₹{{ totalAmount }}
    </div>


    <!-- SUBMIT -->
    <button type="submit">
      Book Now
    </button>


    <!-- SUCCESS -->
    <div *ngIf="successMessage"
         class="success">
      {{ successMessage }}
    </div>

  </form>
  <!-- ✅ Confirmation Dialog -->
<div class="dialog-overlay" *ngIf="showDialog">

  <div class="dialog-box">

    <h3>Confirm Your Booking</h3>

    <p>Are you sure you want to confirm this booking?</p>

    <div class="dialog-details">
      <p><strong>Destination:</strong> {{ booking.destination }}</p>
      <p><strong>Date:</strong> {{ booking.date }}</p>
      <p><strong>Persons:</strong> {{ booking.persons }}</p>
      <p><strong>Total Amount:</strong> ₹{{ totalAmount }}</p>
    </div>

    <div class="dialog-buttons">
      <button class="confirm-btn" (click)="confirmBooking()">
        Confirm
      </button>

      <button class="cancel-btn" (click)="showDialog = false">
        Cancel
      </button>
    </div>

  </div>
</div>
  <!-- Submitted Bookings Section -->
<div *ngIf="submittedBookings.length > 0" class="submitted-section">

  <h3>Your Bookings</h3>

  <div *ngFor="let booking of submittedBookings" class="booking-card">

    <p><strong>Name:</strong> {{ booking.name }}</p>
    <p><strong>Email:</strong> {{ booking.email }}</p>
    <p><strong>Phone:</strong> {{ booking.phone }}</p>
    <p><strong>Destination:</strong> {{ booking.destination }}</p>
    <p><strong>Date:</strong> {{ booking.date }}</p>
    <p><strong>Persons:</strong> {{ booking.persons }}</p>
    <p><strong>Total Amount:</strong> ₹{{ booking.totalAmount }}</p>

  </div>

</div>

</div>
